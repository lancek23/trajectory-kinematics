# trajectory-kinematics

## Table of Contents
1. Introduction
2. Setup Guide
3. Code Files Usage

## Introduction
This repository allows you to capture and run experiments with the kinematic data from the Geolife Trajectory dataset. The goal is to show that the different users have a "kinematic profile." That is, a person tends to move in the same way (for example, similar speeds or rates of acceleration) which is unique to them and should allow us to distinguish them from others.

The dataset captures the raw trajectory data of 182 users in Beijing, China over a period of several years. While the dataset captures several spatial features for each user, we only concern ourselves with the timestamps, longitudes, and latitudes. Using these, we calculate kinematic features of the users over the different trips they take. On each trip, we calculate the distance and time between each consecutive observed (timestamp, longitude, latitude) tuple to extract the speed. We then calculate the acceleration at each timestamp as the difference in consecutive speeds. Using these over a whole trip, we can find our kinematic features. These features include the following:
- duration
- max speed
- min speed
- max positive acceleration
- min negative acceleration (deceleration)
- mean speed
- mean absolute accelerations
- std dev speed
- std dev accelerations
- std dev acbsolute accelerations

Rather than determining what is a "trip" in the data for ourselves, we make use of labeled trips provided by the dataset. These include a start time, end time, and *modality* (car, walk, etc) for the trip, so we may simply look at the parts of the trajectory for the user which falls between the start and end times. Unforunately, these labels are only provided for 73 of the users, so it is only these that we extract kinematic features for.

We offer some recommended reductions on the extracted kinematic data. First, GPS errors lead to unrealistic measurements, so we remove those trips which appear to be outliers. Second, we remove the data of users with less than 30 trips. This way in our experiments, all users have sufficient data.

Finally, we provide two experiments on the kinematic data. First, we perform classification using a DecisionTree, where we classify the trips in the dataset by their users. Second, we perform outlier detection. In this experiment, one user serves as the "normal" class, and trips from other users are added randomly as the outliers.

## Setup Guide
##### Downloading the data
The Geolife dataset is available for download [here](https://www.microsoft.com/en-us/research/publication/geolife-gps-trajectory-dataset-user-guide/). After downloading and unzipping the data, the highest folder (called Geolife Trajectories 1.3) should be placed in the same folder as the code, which should allow all code in this project to run normally and interact with the data with the expected behavior

##### Dependencies
The following python libraries must be installed to run all the files in this project:
- numpy
- pandas
- matplotlib
- sklearn

##### Running the code
All code for this project is in ipynb files. You can simply run them using "Run All," but the code blocks are separated so you may only run parts of it if you desire (for instance, if you don't want to perform the same data reductions on the data that we do).

## Code Files Usage
##### kinematics.ipynb
This file generates the kinematic data by first gathering the raw data from the downloaded Geolife folder, and then calculating the kinematic data for each trip. If you select "Run All," it will attempt to generate 3 files inside a subdirectory called "generated_data." These files are:
- kinematics.feather: This file includes the kinematic data for every labeled trip in the dataset
- clean_kinematics.feather: This file includes the kinematic data for only those trips which we do not consider outliers due to GPS errors
- reduced_kinematics.feather: This file includes only the kinematic data for users which have at least 30 trips in clean_kinematics.feather

We recommend to use reduced_kinematics.feather for experiments, but if you do not want all three files you should run the code one block at a time and ignore those which generate the undesired files.

##### classification.ipynb
This file will read in the data from reduced_kinematics.ipynb (generated by kinematics.ipynb) and perform classification of the trips by their users. We use 5 stratified folds for these experiments and provide classification matrices. There are three classification methods to use:
- Decision Tree Classifier: This uses the default implementation of a decision tree from the sklearn library
- Weighted Random Guess: This selects a label at random with a probability equal to the proportion of that label in the dataset
- True Random Guess: This selects a label at random with equal probability for all labels

##### outlier_detection.ipynb
This file will read in the data from reduced_kinematics.ipynb (generated by kinematics.ipynb) and perform outlier detection in the following way: One user is selected to have their trips be the "normal" class, while other trips from the dataset are added at random to be the "outlier" class. We perform 10 trials per user and compile the results. There are two outlier detection methods to use:
- Local Outlier Factor (LOF): This uses the default implementation of the LOF algorithm from the sklearn library to provide an outlier score for each trip
- Random Guess: This orders the trips by "outlier-ness" at random
